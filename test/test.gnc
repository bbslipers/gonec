Модуль Тест
  Функция Равно(инфо, ожидаемое, настоящее)
    Если настоящее != ожидаемое Тогда
      ВызватьИсключение Формат("%s: ожидалось %v но получено %v", инфо, ожидаемое, настоящее)
    КонецЕсли
  КонецФункции

  Функция Исполнить(арг...)
    Если (Длина(арг) < 2 || ТипЗнч(арг[0]) != "строка" || ТипЗнч(арг[1]) != "функция")  Тогда
      ВызватьИсключение "В Тест.Исполнить должны быть переданы название и функция теста"
    КонецЕсли

    название, тест, арг = арг[0], арг[1], арг[2:]
    Попытка
      Если Длина(арг) == 0 Тогда
        результат, инфо = тест()
      ИначеЕсли Длина(арг) == 1 Тогда
        результат, инфо = тест(арг[0])
      ИначеЕсли Длина(арг) == 2 Тогда
        результат, инфо = тест(арг[0], арг[1])
      ИначеЕсли Длина(арг) == 3 Тогда
        результат, инфо = тест(арг[0], арг[1], арг[2])
      ИначеЕсли Длина(арг) == 4 Тогда
        результат, инфо = тест(арг[0], арг[1], арг[2], арг[3])
      ИначеЕсли Длина(арг) == 5 Тогда
        результат, инфо = тест(арг[0], арг[1], арг[2], арг[3], арг[4])
      Иначе
        результат, инфо = тест(арг...)
      КонецЕсли
    Исключение
      результат, инфо = ложь, ОписаниеОшибки()
    Конецпопытки

    Если Булево(результат) Тогда
      СообщитьФ("Тест %s пройден\n", название)
    Иначе
      ВызватьИсключение Формат("Тест %s провален: %v\n", название, инфо)
    КонецЕсли
  КонецФункции
Модуль _

